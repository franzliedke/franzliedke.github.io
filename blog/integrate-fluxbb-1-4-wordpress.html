<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">


                    <link rel="stylesheet" href="/css/main-3b16b85795.css">
                    <link rel="stylesheet" href="/css/main-f56cb86acb.css">
        
    </head>
    <body>
        <header>
            <h1>
                <a href="/">Franz Liedke</a>
            </h1>

            <nav>
                <ul>
                    <li><a href="/about.html">About me</a></li>
                    <li><a href="/blog">Blog</a></li>
                </ul>
            </nav>

            <p class="about">
                Master of Science, IT-Systems Engineering<br />
                Web developer, Laravel core contributor<br />
                Open-source enthusiast, Flarum &amp; FluxBB
            </p>
        </header>

        <main>
            
    <article>
        <h1>Integrate FluxBB 1.4 with a WordPress site</h1>
        <time class="article-date" datetime="2010-05-23T12:00">2010-05-23</time>
        <p>Somebody asked me to integrate <a href="http://fluxbb.org/">FluxBB</a> into his WordPress site.
I was once more surprised to see how simple it actually is to integrate FluxBB into another piece of software after already experiencing that with the new FluxBB website, though I do not know whether that is a general fact or just luck on my side.</p>
<p>This article will not deal with integrating the FluxBB and the WordPress user accounts, but rather making the forum fit nicely into the overall site design, for example using the site main menu.</p>
<h2>Recommendations</h2>
<p>In general, I have a few recommendations to make regarding integration:</p>
<ul>
<li><strong>Only use one style.</strong>
While it can seem nice to offer your forum users multiple styles to choose from, this is most likely a bad idea when integrating the forum into a site which probably already has some kind of color scheme.
Not only that: different styles sometimes use different font families and sizes, which would make your integration less seamless and probably more clumsy on some styles.
Only using one style also makes it easier to accomodate changes in the FluxBB core or the style itself.</li>
<li><strong>Rename the default style.</strong>
Assuming you are going to start making a forum style that fits well into your site based on the default Air style, it is definitely a good idea to rename that style (or whatever style you use).
As the integration process probably requires some editing of the stylesheets, this keeps them from being overridden when updating the source code.</li>
<li><strong>CSS selectors should use prefixes.</strong>
It is very useful if your style – just like the default styles do it – uses some prefix on its CSS selectors.
That means that all forum pages should be wrapped in a <code>&lt;div&gt;</code> container (<code>#punwrap</code> in the default styles).
This makes integration easier, as there are far less conflicts between the forum’s and the site’s stylesheet rules.</li>
</ul>
<h2>Step 1: Loading the WordPress Core</h2>
<p>Integrating parts of another site into a FluxBB style is very easy thanks to the <code>&lt;pun_include&gt;</code> tags.
These can be used to include custom PHP (or other) files from either the <code>include/user/</code> directory (if it does not exist, simply create it yourself) of your FluxBB copy or the directory of the style itself.</p>
<p>So, in our imaginary WordPress site, we would want to display the site’s dynamic header and footer above and below the forum, too.
WordPress’ theme architecture helps us with this: It’s themes’ files are split up into different sections, two of them header and footer.</p>
<p>Both template files contain a lot of WordPress functions, though, which means that they cannot just be included from the forum template.
To gain access to WordPress’ functionality, we have to include it’s loader file, <code>wp-load.php</code>, too.
The good news is that that makes loading the header and footer templates even easier, since we now have access to convenient functions.</p>
<p>So, to get started, create a file called <code>header.php</code> with the following contents in your forum’s <code>include/user/</code> directory.</p>
<pre><code class="language-php">&lt;?php
define('WP_ROOT', PUN_ROOT.'../');

require WP_ROOT.'wp-blog-header.php';
get_header();</code></pre>
<p>Note: You need to set <code>WP_ROOT</code> to the directory where the WordPress files are located.
In this case, I assumed that FluxBB sits in a subfolder (e.g. <code>forums/</code>) of the main site.
You can use <code>PUN_ROOT</code> to specify a directory relative to the FluxBB base path.</p>
<p>In the same way, we create a file <code>footer.php</code>:</p>
<pre><code class="language-php">&lt;?php
get_footer();</code></pre>
<p>This time we don’t have to load any WordPress files, since they are already included in the header.</p>
<p>Now we have some files with dynamic contents for our FluxBB template.
To actually insert them into the header, we have to use the <code>&lt;pun_include&gt;</code> tags mentioned above.</p>
<p>So, to use WordPress’ header, open your style’s main template file.
It is called <code>main.tpl</code> and you can usually find it in the <code>/style/&lt;your_style_name&gt;</code> directory.
If it doesn’t exist, switch to the <code>/include/template</code> directory and copy the <code>main.tpl</code> from there to your style’s folder.
This again prevents your changes from being overwritten when upgrading.
In that file, replace everything from the very beginning down to and including the opening <code>&lt;body&gt;</code> tag with the following code snippet:</p>
<pre><code class="language-html">&lt;pun_include "header.php"&gt;</code></pre>
<p>We do the same for the footer by replacing everything starting at the closing <code>&lt;/body&gt;</code> tag down to the end of the file with this code:</p>
<pre><code class="language-html">&lt;pun_include "footer.php"&gt;</code></pre>
<p>If you visit your forum now, you will probably see its output between your site’s header and footer, but without any styling.</p>
<p><strong>UPDATE:</strong>
A few readers reported problems with executing some actions in the forum.
Adding the following line right after the opening PHP tag in FluxBB’s <code>header.php</code> file seemed to solve the issue:</p>
<pre><code class="language-php">global $wp, $wp_query, $wp_the_query;</code></pre>
<h2>Step 2: Loading the FluxBB stylesheets from WordPress</h2>
<p>Loading the WordPress header also means that the WordPress stylesheets are included instead of the FluxBB ones.
That means that we somehow have to insert those in the WordPress header template.
The problem: stylesheet inclusions and other header elements like RSS feed links etc. are generated dynamically.</p>
<p>Replicating that functionality in WordPress is possible, but not recommendable, because changes in the core would have to be replicated, too.
Luckily enough, the <code>&lt;pun_head&gt;</code> tag is used to insert the dynamic header code into the FluxBB templates, too.
Even better: <code>&lt;pun_include&gt;</code> tags are executed before other tags, so that we can actually use the <code>&lt;pun_head&gt;</code> tag in the WordPress template.</p>
<p>The header code which is generated by FluxBB consists of stylesheets, meta tags and feed links as well as a page title.
The latter would cause conflicts with the WordPress template, as that already contains this tag.
Instead of somehow stripping the title from FluxBB’s header code, we just use the one from the forum instead.</p>
<p>This only requires a small edit to the WordPress theme header file.
Somewhere in it there should be an opening <code>&lt;title&gt;</code> and a closing <code>&lt;/title&gt;</code> tag with some content in between (probably PHP code).
We switch between the forum’s header and the site’s title by replacing the title tag mentioned above with the following code snippet:</p>
<pre><code class="language-php">&lt;?php if (defined('PUN_ROOT')) : ?&gt;
&lt;pun_head&gt;
&lt;?php else: ?&gt;
&lt;title&gt;...here goes the old title code...&lt;/title&gt;
&lt;?php endif; ?&gt;</code></pre>
<p>With this done, you can now try visiting the forum.
You should see it sitting properly between your site’s header and footer. Well done!</p>
<h2>Step 3: Finishing</h2>
<p>Integration probably wouldn’t be integration if it worked correctly from the very beginning on.
Well, it should be working now.
However, usually there are some rules in the forum stylesheet that make the display a little weird (obviously depending on the site’s markup).</p>
<p>As an example:
Assuming you are using the default “Air” style as a starting point for your forum style, you will probably notice that there is a lot of whitespace on the top and the bottom as well as on the sides of the forum.
In this case, you would have to remove the following lines from your <code>/style/&lt;your_style_name&gt;.css</code> file:</p>
<pre><code class="language-css">.pun {
    padding: 30px 40px;
}</code></pre>
<p>And now enjoy your integrated forum!</p>

        <div id="disqus_thread"></div>
<script>
    (function() {
        var d = document, s = d.createElement('script');

        s.src = '//develophp.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>    </article>

        </main>
    </body>
</html>
